{% extends "base.html" %} {% block title %}Admin Dashboard - Meeting Room
Booking System{% endblock %} {% block content %}
<h2>Admin Dashboard</h2>

<h3>All Bookings</h3>
{% if bookings %}
<table border="1">
  <thead>
    <tr>
      <th>Booking ID</th>
      <th>Employee</th>
      <th>Room</th>
      <th>Start Time</th>
      <th>End Time</th>
      <th>Actions</th>
    </tr>
  </thead>
  <tbody>
    {% for booking in bookings %}
    <tr>
      <td>{{ booking.bookingid }}</td>
      <td>{{ booking.employee.fname }} {{ booking.employee.lname }}</td>
      <td>{{ booking.room.roomname }} (Floor {{ booking.room.floor }})</td>
      <td>{{ booking.timebegin }}</td>
      <td>{{ booking.timefinish }}</td>
      <td>
        <form
          method="POST"
          action="{{ url_for('cancel_booking', booking_id=booking.bookingid) }}"
          style="display: inline"
        >
          <button
            type="submit"
            onclick="return confirm('Are you sure you want to cancel this booking?')"
          >
            Cancel
          </button>
        </form>
      </td>
    </tr>
    {% endfor %}
  </tbody>
</table>
{% else %}
<p>No bookings in the system.</p>
{% endif %}

<hr />

<h3>All Employees</h3>
{% if employees %}
<table border="1">
  <thead>
    <tr>
      <th>Employee ID</th>
      <th>Name</th>
      <th>Email</th>
      <th>Role</th>
    </tr>
  </thead>
  <tbody>
    {% for employee in employees %}
    <tr>
      <td>{{ employee.employeeid }}</td>
      <td>{{ employee.fname }} {{ employee.lname }}</td>
      <td>{{ employee.email }}</td>
      <td>{{ employee.role }}</td>
    </tr>
    {% endfor %}
  </tbody>
</table>
{% else %}
<p>No employees in the system.</p>
{% endif %}

<h4>Create New User</h4>
<form method="POST" action="{{ url_for('admin_create_user') }}">
  <div>
    <label for="fname">First Name:</label>
    <input type="text" id="fname" name="fname" required />
  </div>
  <div>
    <label for="lname">Last Name:</label>
    <input type="text" id="lname" name="lname" required />
  </div>
  <div>
    <label for="email">Email:</label>
    <input type="email" id="email" name="email" required />
  </div>
  <div>
    <label for="password">Password:</label>
    <input type="password" id="password" name="password" required />
  </div>
  <div>
    <label for="role">Role:</label>
    <select id="role" name="role" required>
      <option value="staff">Staff</option>
      <option value="senior">Senior</option>
      <option value="admin">Admin</option>
    </select>
  </div>
  <div>
    <button type="submit">Create User</button>
  </div>
</form>

<hr />

<h3>All Rooms</h3>
{% if rooms %}
<table border="1">
  <thead>
    <tr>
      <th>Room ID</th>
      <th>Room Name</th>
      <th>Floor</th>
      <th>Capacity</th>
    </tr>
  </thead>
  <tbody>
    {% for room in rooms %}
    <tr>
      <td>{{ room.roomid }}</td>
      <td>{{ room.roomname }}</td>
      <td>{{ room.floor }}</td>
      <td>{{ room.capacity }}</td>
    </tr>
    {% endfor %}
  </tbody>
</table>
{% else %}
<p>No rooms in the system.</p>
{% endif %}

<h4>Create New Room</h4>
<form method="POST" action="{{ url_for('admin_create_room') }}">
  <div>
    <label for="roomname">Room Name:</label>
    <input type="text" id="roomname" name="roomname" required />
  </div>
  <div>
    <label for="floor">Floor:</label>
    <input type="number" id="floor" name="floor" required />
  </div>
  <div>
    <label for="capacity">Capacity:</label>
    <input type="number" id="capacity" name="capacity" required />
  </div>
  <div>
    <button type="submit">Create Room</button>
  </div>
</form>

<hr />

<h3>Support Tickets</h3>
{% if tickets %}
<table border="1">
  <thead>
    <tr>
      <th>Ticket ID</th>
      <th>Employee</th>
      <th>Subject</th>
      <th>Message</th>
      <th>Created At</th>
      <th>Action</th>
    </tr>
  </thead>
  <tbody>
    {% for ticket in tickets %}
    <tr>
      <td>{{ ticket.ticketid }}</td>
      <td>{{ ticket.employee.fname }} {{ ticket.employee.lname }}</td>
      <td>{{ ticket.subject }}</td>
      <td>{{ ticket.message }}</td>
      <td>{{ ticket.created_at }}</td>
      <td>
        <form
          method="POST"
          action="{{ url_for('delete_ticket', ticket_id=ticket.ticketid) }}"
          style="display: inline"
        >
          <button
            type="submit"
            onclick="return confirm('Are you sure you want to delete this ticket?')"
          >
            Cancel
          </button>
        </form>
      </td>
    </tr>
    {% endfor %}
  </tbody>
</table>
{% else %}
<p>No support tickets in the system.</p>
{% endif %} {% endblock %}
